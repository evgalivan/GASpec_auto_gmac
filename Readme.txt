Программа для автоматизации анализа при работе в GASpec
Автор: Иванов Е.А.
Дата выпуска программы: 18.01.2023

Состав программы:
	auto_gmac.py - модуль для автоматического анализа конечного числа спектров по нажатию горячей клавиши.
	auto_agregator.py - модуль для сбора результатов анализа в один файл
Язык программирования: Python
Версия: Python 3.10.8 (tags/v3.10.8:aaaf517, Oct 11 2022, 16:50:30)

Библиотеки для скачивания: 
keyboard 0.13.5 Выпущен: 24 мар. 2020 г.
https://pypi.org/project/keyboard/

Установка программы:
	Это скрипты, которые не требуют дополнительной установки.
	Запускаются или через командную строчку:

	$ python auto_gmac.py
	
	или непосредственно через среду Python
	
	Для работы скриптов на рабочей станции необходимо наличие Python не младше версии 3.10.8
	
Руководство пользователя auto_gmac.py
	Скрипт auto_gmac.py нужно для того, чтобы имитировать работу оператора нажатием определенной последовательности кнопок.
	Так как скрип использует вашу клавиатуру, то после запуска конечного автомата нельзя пользоваться вашим ПК, поэтому пока скрип работает, займитесь чем-нибудь еще
	Например, разомнитесь или попейте чайку.
	
	Перед началом запуска скрипта необходимо:
	1) Предварительно настроить GASpec, а именно выбрать в меню Параметры-GASpec, затем в окне Параметры, вкладке GASpec выберете вкладку метод и установите галочку "Предлагать сохранять текстовый отчет"
	2) Убедитесь, что у вас выбран нужный метод.
	3) Снимите галочки "Измерение" и "Непрерывное"
	4) Откройте нужные спектры: Файл-Открыть"
	
	Итак вы подготовились и теперь можете запускать скрипт.
	
	Сразу после запуска программы, вам нужно будет ввести количество спектров, которое вы хотите обработать. Спектров должно быть больше одного, иначе программа сработает не правильно.
	Важно! Перед обработкой большого числа спектров, проверьте, что автомат работает на 1-2 изимерениях. Это поможет избежать ошибок при анализе спектров.
	
	После того, как нужно количество спектров выбрано, программа будет запущена в фоновом режиме и для активации автоматического цикла нажатия клавш с клавиатуры необходимо нажать горячую клавишу "ctrl+alt+a"
	
	Программа начнет выполнять действия конечного автомата сама через 3 секунды после нажатия горячей клавиши.
	Важно! Автомат начинает работу с некоторого стартого состояния программы GASpec и нажимает клавиши на клавиатуре за вас. Это значит, что нужно убедиться, что ваша программа находится в стартовом положении.
	
	Чтобы установить прорамму в стартовое положение есть два пути:
	Первый
		1) Закрыть GASpec с заранее установленным методом и открыть ее снова.
		2) Открыть спектры.
		3) Готово
	Второй:
		1) Нажать кнопку "Анализ"->Выбрать один спектр и нажать ОК->нажать ОК->нажать Анализ->На вопрос отвечаем "Да"-> файл отчета сохраняем в любую папку с любым именем(GASpec запомнит эту папку до перезапуска)
		-> Далее закрываем окно "Выберите спектры:" на "Крестик"(это важно!)
		2) Готово
	
	В результате работы программы у вас появится набор N файлов с именем ####.txt, где N - количество спектров которые вы ввели в начале программы, а # - числа от 0 до 9.
	
	Каждый такой файл программа GASpec сохраняет по умолчанию в папку, где лежат спектры, откуда вы можете их благополучно скопировать в отдельную папку. Эти файлы нам понадобятся для работы другого модуля программы.
	
	Перейдем к нему.
	
Руководство пользователя auto_agregator.py
	Скрипт auto_agregator.py из файлов с именем 0###.txt(# - числа от 0 до 9) выбирает нужные поля и складывает в один общий файл с именем MyFile.txt
	
	Для работы скрипта нужно будет подготовить рабочую папку, в который вы будете генерировать общий файл с результатами анализа.
	
	1) Для работы скрипта необходимо, чтобы файл скрипта находился в той же папке, что и файлы, которые появились, после работы auto_gmac.py
	Примечание. Совсем не обязательно, чтобы в папке были только файлы с результами анализа GASpec, там же могут быть и файлы с любыми расширениями, каталоги и другие файлы *.txt (название которых не начинается с символа Нуль)
	
	2) Затем просто запускайте скрипт и в результате работы создает в текущей папке файл с именем MyFile.txt
	
	Какие же поля выбирает этот скрипт. Подробнее

	Это содержание файла с результатами анализа спектра
Спектр: CH4-2_пропускание1106.spe
Заголовок CH4-2_1106 / оч-й воздух_1046
Метод: Метод CH4 2845-3220.mtd
CH4	2.065 ppm	2845.0 - 3220.0	0.061315 (0.99976 )

	Программа выдергивает из второй строки CH4-2_1106 по ключевому слову "Заголовок" и разделителю "пробел"
	Программа выдергивает из четвертой строки 2.065 по разделителю "табуляция" и разделителю пробел"

	Пример работы программы на 3ех файлах с результатами анализа

0001.txt
Спектр: CH4-2_пропускание1108.spe
Заголовок CH4-2_1108 / оч-й воздух_1046
Метод: Метод CH4 2845-3220.mtd
CH4	2.075 ppm	2845.0 - 3220.0	0.061315 (0.99976 )	

0002.txt
Спектр: CH4-3_пропускание1122.spe
Заголовок CH4-3_1122 / оч-й воздух_1046
Метод: Метод CH4 2845-3220.mtd
CH4	2.949 ppm	2845.0 - 3220.0	0.061315 (0.99976 )	

0003.txt
Спектр: CH4-3_пропускание1124.spe
Заголовок CH4-3_1124 / оч-й воздух_1046
Метод: Метод CH4 2845-3220.mtd
CH4	2.95 ppm	2845.0 - 3220.0	0.061315 (0.99976 )	

	После запуска скрипта появится файл с именем MyFile.txt
	
MyFile.txt
CH4-2_1108	2,075
CH4-3_1122	2,949
CH4-3_1124	2,95

	Примечание: символ точки заменяется на запятую для последующего экспорта в Excel
	Если это не нужно, то с помощью любого тектого редактора отредактируйте код скрипта в ручную:

строка 26	line = line.replace('.', ',')
Замените на 
строка 26	#line = line.replace('.', ',')